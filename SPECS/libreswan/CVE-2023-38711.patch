diff --show-c-function -Naur a/programs/pluto/ikev1_quick.c b/programs/pluto/ikev1_quick.c
--- a/programs/pluto/ikev1_quick.c	2022-05-24 10:23:22.000000000 -0700
+++ b/programs/pluto/ikev1_quick.c	2023-08-28 16:14:43.012112514 -0700
@@ -1918,6 +1918,11 @@ static struct connection *fc_try(const s
 				 const ip_selector *local_client,
 				 const ip_selector *remote_client)
 {
+	if (selector_is_unset(local_client) ||
+	    selector_is_unset(remote_client)) {
+		return NULL;
+	}
+
 	struct connection *best = NULL;
 	policy_prio_t best_prio = BOTTOM_PRIO;
 	const bool remote_is_host = selector_eq_address(*remote_client,
@@ -2101,6 +2106,11 @@ static struct connection *fc_try_oppo(co
 				      const ip_selector *local_client,
 				      const ip_selector *remote_client)
 {
+	if (selector_is_unset(local_client) ||
+	    selector_is_unset(remote_client)) {
+		return NULL;
+	}
+
 	struct connection *best = NULL;
 	policy_prio_t best_prio = BOTTOM_PRIO;
 
@@ -2222,6 +2232,16 @@ struct connection *find_v1_client_connec
 			str_selectors(local_client, remote_client, &sb));
 	}
 
+	if (selector_is_unset(local_client)) {
+		dbg("peer's local client is not set");
+		return NULL;
+	}
+
+	if (selector_is_unset(remote_client)) {
+		dbg("peer's remote client is not set");
+		return NULL;
+	}
+
 	/*
 	 * Give priority to current connection
 	 * but even greater priority to a routed concrete connection.
